<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ç¼–è¯‘ä¼˜åŒ–</title>
  </head>

  <body>
    <div id="app"></div>
    <script type="module">
      import {
        createVNode as _createElementVNode,
        toDisplayString as _toDisplayString,
        openBlock as _openBlock,
        createElementBlock as _createElementBlock,
        render,
        h,
        reactive,
        toRefs,
      } from '/node_modules/vue/dist/vue.runtime.esm-browser.js';

      // import {
      //   render,
      //   h,
      //   reactive,
      //   toRefs,
      //   createVNode as _createElementVNode,
      //   toDisplayString as _toDisplayString,
      //   openBlock as _openBlock,
      //   createElementBlock as _createElementBlock,
      // } from './runtime-dom.js';

      // lesson-52 é¶å‘æ›´æ–°
      // const MyComponent = {
      //   setup() {
      //     const state = reactive({
      //       a: 1,
      //       name: 'pb',
      //     });

      //     setTimeout(() => {
      //       state.a = 2;
      //       state.name = 'pb_updated';
      //     }, 1000);

      //     return {
      //       ...toRefs(state),
      //     };
      //   },
      //   render(_ctx) {
      //     const vnode =
      //       (_openBlock(),
      //       _createElementBlock('div', null, [
      //         _createElementVNode('h1', null, 'Hello! pb'),
      //         _createElementVNode(
      //           'span',
      //           null,
      //           _toDisplayString(_ctx.name),
      //           1 /* TEXT */ // æ¨¡æ¿ç¼–è¯‘çš„æ—¶å€™ï¼Œæ·»åŠ çš„patchFlag
      //         ),
      //       ]));
      //     console.log(
      //       'ðŸš€ ~ file: compile-opt.html ~ line 56 ~ render ~ vnode',
      //       vnode
      //     );

      //     return vnode;
      //   },
      // };

      // render(h(MyComponent), app);

      // lesson-53 BlockTree
      const MyComponent = {
        setup() {
          const state = reactive({
            a: 'pb',
            flag: true,
          });

          setTimeout(() => {
            state.a = 'pb_updated';
            state.flag = false;
          }, 1000);

          return {
            ...toRefs(state),
          };
        },
        render(_ctx) {
          const vnode =
            (_openBlock(),
            _createElementBlock('div', null, [
              _ctx.flag
                ? (_openBlock(),
                  _createElementBlock('p', { key: 0 }, [
                    _createElementVNode(
                      'span',
                      null,
                      _toDisplayString(_ctx.a),
                      1 /* TEXT */
                    ),
                  ]))
                : (_openBlock(),
                  _createElementBlock('div', { key: 1 }, [
                    _createElementVNode(
                      'span',
                      null,
                      _toDisplayString(_ctx.a),
                      1 /* TEXT */
                    ),
                  ])),
            ]));
          console.log(
            'ðŸš€ ~ file: compile-opt.html ~ line 93 ~ render ~ vnode',
            vnode
          );

          return vnode;
        },
      };

      render(h(MyComponent), app);
    </script>
  </body>
</html>
