<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>ref</title>
  </head>

  <body>
    <div id="app"></div>
    <script type="module">
      // 这是原生的
      // import {
      //   reactive,
      //   effect,
      //   ref,
      // } from '/node_modules/vue/dist/vue.esm-browser.js';

      // 这是自己实现调试用的
      import { reactive, effect, ref } from './reactivity.js';

      // lesson-12 ref实现原理
      // const flag = ref(false);
      // console.log('🚀 ~ file: index.html ~ line 194 ~ flag', flag.value);
      // effect(() => {
      //   app.innerHTML = flag.value ? 'pb' : 30;
      // });
      // setTimeout(() => {
      //   flag.value = true;
      // }, 1000);
      // ref对象内部结构伪代码：
      // let flag1 = {
      //   _v: false,
      //   get value() {
      //     // 收集effect
      //     return this._v;
      //   },
      //   set value(newValue) {
      //     // 更新effect
      //     this._v = newValue;
      //   },
      // };

      // lesson-13 toRef/toRefs实现原理
      // const state = reactive({ name: 'pb', age: 30 });
      // const nameRef = toRef(state, 'name'); // 还是基于Proxy来获取
      // const ageRef = toRef(state, 'age');
      // console.log(nameRef.value); // 通过state.value来获取值
      // console.log(ageRef.value);
      // let { name, age } = toRefs(state);
      // console.log(name, age);

      // 模板中，直接使用响应式变量，不需要添加.value，就是使用了这个API
      // let proxy = proxyRefs({ ...toRefs(state), a: 100 });
      // proxy.age = 100; // proxy.age.value = 100;
      // proxy.a = 200;
      // effect(() => {
      //   console.log(proxy.name, proxy.age, proxy.a);
      // });
    </script>
  </body>
</html>
